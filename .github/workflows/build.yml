name: macOS DeviceCheck

on: [push, pull_request]

jobs:
  build:
    runs-on: macos-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Xcode
      run: |
        sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer

    - name: Compile and run Objective-C code
      run: |
        # Compile the Objective-C code
        clang -fobjc-arc -framework Foundation -framework DeviceCheck token-generator.m -o devicecheck
        
        # Run the compiled binary
        ./devicecheck
